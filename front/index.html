<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPA</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>    
    <nav class="nav">
    <a href="/" class="nav__link" data-link>Dashboard</a>
    <a href="/Authors" class="nav__link" data-link>Authors</a>
    <a href="/posts" class="nav__link" data-link>Posts</a>
    <a href="/Books" class="nav__link" data-link>Books</a>
    </nav>
    <div id="app"></div>
    <script type="module" src="index.js"></script>
    <script>
        function addAuthor() {
            let fname =document.getElementById("firstname").value ;
            let lname =document.getElementById("lastname").value ;
            const dataToSent = {
                name : fname,
                surname : lname
            }
            const options =     {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dataToSent)
        };
        fetch('/addNewAuthor',options)
        }

        function addBook(){
            let title =  document.getElementById("title").value ;
            let pages =  document.getElementById("pages").value ;
            let date =  document.getElementById("date").value ;
            
            //adding authors
            let authors = new Array()
          for(let i =1; i <= 3; i++){  
              let aut = document.getElementById("author"+i).value ;
             const words = aut.split(' ');
             let authorID = words[2]
                if(authorID != '666'){
                    authors.push(authorID)
                }
            }
            const dataToSent = {
                title: title,
                pages: pages,
                date: date,
                authors: authors
            }
            const options =     {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dataToSent)
        };
        fetch('/addNewBook',options)
            
        }


        function deleteAuthor(){
             let aut = document.getElementById("authorToDelete").value ;
             const words = aut.split(' ');
             let idToDelete = words[2]
             const dataToSent = {
                id : idToDelete,
            }
             const options =     {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dataToSent)
        };
        fetch('/deleteAuthor',options)
        }

        function deleteBook(){
            let bk = document.getElementById("bookToDelete").value ;
            const words = bk.split(' ');
             let idToDelete = words[1]
             const dataToSent = {
                id : idToDelete,
            }
             const options =     {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dataToSent)
        };
        fetch('/deleteBook',options)
        }
        
    </script>
</body>
</html>